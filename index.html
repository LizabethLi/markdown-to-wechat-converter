<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown to 微信公众号排版转换器</title>
    
    <!-- 外部CSS -->
    <link rel="stylesheet" href="styles/main.css">
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid for flowchart rendering -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <!-- MathJax配置和加载 -->
    <script src="js/config.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
    <div id="scratch" style="display:none;"></div>
    
    <div class="header">
        <h1> Markdown Converter</h1>
        <p> Translate Markdown to WeChat Format or GitHub (Markdown) </p>
        <p><a href="https://github.com/LizabethLi/markdown-to-wechat-converter" target="_blank" rel="noopener noreferrer">GitHub Link</a></p>
    </div>
    
    <div class="container">
        <div class="panel">
            <div class="panel-header">
                <!-- <span class="panel-title"> Markdown Input</span> -->
                <div>
                    <select id="channelSelect" style="margin-right: 10px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;" onchange="updateOutput()" title="选择输出渠道">
                        <option value="wechat">WeChat</option>
                        <option value="github">GitHub (Markdown)</option>
                    </select>
                    <select id="templateSelect" style="margin-right: 10px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;" title="选择模板">
                        <option value="wechat-default">默认模板</option>
                    </select>
                    <div class="theme-selector" style="display: inline-block; position: relative; margin-right: 10px;">
                        <button id="themeButton" class="btn theme-btn" onclick="toggleThemePanel()" title="选择主题色">
                            🎨
                        </button>
                        <div id="themePanel" class="theme-panel" style="display: none;">
                            <div class="theme-panel-header">选择主题色</div>
                            <div class="theme-options">
                                <div class="theme-option" data-theme="purple" onclick="selectTheme('purple')">
                                    <div class="theme-color" style="background: #7E3AF2;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">经典紫色</div>
                                        <div class="theme-desc">优雅专业</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="blue" onclick="selectTheme('blue')">
                                    <div class="theme-color" style="background: #2563EB;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">商务蓝色</div>
                                        <div class="theme-desc">商务正式</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="orange" onclick="selectTheme('orange')">
                                    <div class="theme-color" style="background: #EA580C;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">活力橙色</div>
                                        <div class="theme-desc">活泼创新</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="green" onclick="selectTheme('green')">
                                    <div class="theme-color" style="background: #16A34A;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">自然绿色</div>
                                        <div class="theme-desc">清新自然</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="red" onclick="selectTheme('red')">
                                    <div class="theme-color" style="background: #DC2626;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">激情红色</div>
                                        <div class="theme-desc">热情活力</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="cyan" onclick="selectTheme('cyan')">
                                    <div class="theme-color" style="background: #0891B2;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">深海蓝</div>
                                        <div class="theme-desc">稳重深沉</div>
                                    </div>
                                </div>
                                <div class="theme-option" data-theme="mint" onclick="selectTheme('mint')">
                                    <div class="theme-color" style="background: #01fabd;"></div>
                                    <div class="theme-info">
                                        <div class="theme-name">薄荷青</div>
                                        <div class="theme-desc">清爽活力</div>
                                    </div>
                                </div>
                                <hr class="theme-divider">
                                <div class="theme-option custom-color-option" style="display: flex; align-items: center; cursor: default;">
                                    <input id="customColorInput" type="text" maxlength="9" placeholder="#RRGGBB" class="custom-color-input" oninput="UIController.previewCustomColor()" style="margin-right: 10px; width: 90px;" />
                                    <div id="customColorPreview" class="custom-color-preview" style="width: 24px; height: 24px; border-radius: 6px; border: 1px solid #ddd; margin-right: 10px;"></div>
                                    <button class="btn custom-color-btn" onclick="UIController.applyCustomColor()">应用自定义颜色</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="theme-selector" style="display: inline-block; position: relative; margin-right: 10px;">
                        <button id="translatorButton" class="btn theme-btn" onclick="toggleTranslatorPanel()" title="翻译设置">
                            ⚙️
                        </button>
                        <div id="translatorPanel" class="theme-panel" style="display: none;">
                            <div class="theme-panel-header">翻译设置</div>
                            <div class="theme-options">
                                <div class="theme-option" style="cursor: default;">
                                    <div class="theme-info" style="width: 100%;">
                                        <div class="theme-name">服务提供方</div>
                                        <select id="translatorProvider" class="custom-color-input" style="width: 100%; margin-top: 6px;" onchange="UIController.onTranslatorProviderChange()">
                                            <option value="openrouter">OpenRouter</option>
                                            <option value="gemini">Gemini</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="theme-option" style="cursor: default;">
                                    <div class="theme-info" style="width: 100%;">
                                        <div class="theme-name" id="translatorApiKeyLabel">翻译 API Key</div>
                                        <input id="translatorApiKey" type="password" placeholder="粘贴你的 API Key" class="custom-color-input" style="width: 100%; margin-top: 6px;" />
                                        <div style="font-size: 12px; color: #666; margin-top: 4px;">本地保存到浏览器，仅用于当前设备</div>
                                    </div>
                                </div>
                                <div class="theme-option" style="cursor: default;">
                                    <div class="theme-info" style="width: 100%;">
                                        <div class="theme-name">System Prompt（可选）</div>
                                        <textarea id="translatorSystemPrompt" placeholder="例如：保持 Markdown 结构；术语表：LLM→LLM，大模型→foundation model；风格：清晰、简洁" class="custom-color-input" style="width: 100%; height: 120px; margin-top: 6px;"></textarea>
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: flex-end; gap: 8px; padding: 8px;">
                                    <button class="btn custom-color-btn" onclick="UIController.saveTranslatorSettings()">保存并应用</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="btn" onclick="loadExample()">Load Example</button>
                </div>
            </div>
            <div id="channelReminder" class="channel-reminder" role="alert"></div>
            <div class="panel-content">
                <textarea id="markdownInput" placeholder="在这里输入你的 Markdown 内容...

💡 使用提示：
• 支持嵌套列表：使用4个空格缩进表示下一级

示例：
# 这是主标题
## 这是副标题  
### 这是小标题

这是一段正文，支持 **粗体** 和 *斜体*。

- **一级列表项目1**
    - 二级列表项目1
    - 二级列表项目2
        - 三级列表项目1
        - 三级列表项目2
- **一级列表项目2**
    - 二级列表项目3

> 这是引用内容

```javascript
console.log('Hello, world!');
```

| 表头1 | 表头2 |
|---|---|
| 单元格1 | 单元格2 |

行内公式：$E = mc^2$

块级公式：$$ \frac{-b \pm \sqrt{b^2-4ac}}{2a} $$

![图片描述](https://via.placeholder.com/400x200)

🔥 复制到微信公众号时请使用【粘贴并保留格式】或【Ctrl+Shift+V】
"></textarea>
            </div>
        </div>
        
        <div class="panel">
            <div class="tabs">
                <button class="tab active" onclick="showTab('preview')">🔍 Preview</button>
                <button id="codeTabButton" class="tab" onclick="showTab('html')">📄 HTML</button>
            </div>
            
            <div id="previewTab" class="tab-content active">
                <div class="panel-header">
                    <span class="panel-title">👀 效果预览 (可滚动查看)</span>
                    <button class="btn" id="copyPreviewBtn" onclick="copyPreview()">复制样式代码</button>
                </div>
                <div id="preview" class="wechat-preview"></div>
            </div>
            
            <div id="htmlTab" class="tab-content">
                <div class="panel-header">
                    <span id="codeTabTitle" class="panel-title">📋 HTML 代码 (可滚动查看)</span>
                    <button class="btn" id="copyHtmlBtn" onclick="copyHtml()">复制代码</button>
                </div>
                <textarea id="htmlOutput" readonly></textarea>
            </div>
        </div>
    </div>
    
    <!-- 外部JavaScript模块 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/3.0.8/marked.min.js"></script>
    <script src="js/template-manager.js"></script>
    <script src="js/wechat-styles.js"></script>
    <script src="js/templates/wechat-default.js"></script>
    <script src="js/templates/wechat-minimal.js"></script>
    <script src="js/templates/wechat-magazine.js"></script>
    <script src="js/templates/wechat-notebook.js"></script>
    <script src="js/translator.js"></script>
    <script src="js/channel-converter.js"></script>
    <script src="js/math-renderer.js"></script>
    <script src="js/markdown-converter.js"></script>
    <script src="js/ui-controller.js"></script>
    <script src="assets/examples.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
