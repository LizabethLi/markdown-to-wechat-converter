<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown to ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÊéíÁâàËΩ¨Êç¢Âô®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            height: calc(100vh - 180px);
            min-height: 600px;
        }
        
        .panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .panel-header {
            background: #f8fafc;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .panel-title {
            font-weight: 600;
            color: #334155;
            font-size: 1.1rem;
        }
        
        .btn {
            background: #7E3AF2;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: #6d28d9;
            transform: translateY(-1px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn.success {
            background: #10b981;
        }
        
        .panel-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        #markdownInput {
            flex: 1;
            border: none;
            padding: 1.5rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            outline: none;
            background: #fafafa;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        
        #markdownInput::-webkit-scrollbar {
            width: 8px;
        }
        
        #markdownInput::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        #markdownInput::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        #markdownInput::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        #htmlOutput {
            flex: 1;
            border: none;
            padding: 1.5rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 12px;
            line-height: 1.4;
            resize: none;
            outline: none;
            background: #f8f9fa;
            color: #495057;
            overflow-y: auto;
            max-height: calc(100vh - 400px);
            min-height: 400px;
            scroll-behavior: smooth;
        }
        
        #htmlOutput::-webkit-scrollbar {
            width: 8px;
        }
        
        #htmlOutput::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        #htmlOutput::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        #htmlOutput::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        #preview {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background: white;
            max-height: calc(100vh - 400px);
            min-height: 400px;
            scroll-behavior: smooth;
        }
        
        /* KaTeX Â≠ó‰ΩìÂ§ßÂ∞èË∞ÉÊï¥ */
        .katex { font-size: 1.1em; }
        
        #preview::-webkit-scrollbar {
            width: 8px;
        }
        
        #preview::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        #preview::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        #preview::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        .tabs {
            display: flex;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            color: #64748b;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .tab.active {
            color: #7E3AF2;
            border-bottom-color: #7E3AF2;
            background: white;
        }
        
        .tab-content {
            display: none;
            flex: 1;
            flex-direction: column;
        }
        
        .tab-content.active {
            display: flex;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                height: auto;
                gap: 1rem;
                padding: 1rem;
                min-height: auto;
            }
            
            .panel {
                height: 500px;
                min-height: 500px;
            }
            
            #preview, #htmlOutput {
                max-height: 350px;
                min-height: 350px;
            }
            
            #markdownInput {
                min-height: 350px;
            }
        }
        
        /* ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑Ê†∑ÂºèÈ¢ÑËßà */
        .wechat-preview {
            font-family: "PingFang SC", system-ui, -apple-system, "Helvetica Neue", "Microsoft YaHei", Arial, sans-serif;
            color: rgba(0, 0, 0, 0.9);
            line-height: 1.5em;
        }
        
        .demo-section {
            margin: 2rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #7E3AF2;
        }
        
        .demo-title {
            font-weight: 600;
            color: #7E3AF2;
            margin-bottom: 1rem;
        }
        
        table {
            border-collapse: collapse;
            margin: 15px 0;
            width: 100%;
            border: 1px solid #e2e8f0;
        }
        
        th, td {
            border: 1px solid #e2e8f0;
            padding: 10px 12px;
            text-align: left;
        }
        
        th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #334155;
        }
        
        tr:nth-child(even) {
            background-color: #f8fafc;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruJ+a13U8yHIkAyOUuD3QAWDk/a3KYZ2/f9S62AANe4e1HN5dgTICI+VE9aLJ9" crossorigin="anonymous">
</head>
<body>
    <div id="scratch" style="display:none;"></div>
    <div class="header">
        <h1>üìù Markdown to ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÊéíÁâàËΩ¨Êç¢Âô®</h1>
        <p>‰∏ÄÈîÆÂ∞Ü Markdown ËΩ¨Êç¢‰∏∫ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑Ê†∑ÂºèÔºåÊîØÊåÅÂÆûÊó∂È¢ÑËßà</p>
    </div>
    
    <div class="container">
        <div class="panel">
            <div class="panel-header">
                <span class="panel-title">üìù Markdown ËæìÂÖ•</span>
                <div>
                    <select id="modeSelect" style="margin-right: 10px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;" onchange="updateOutput()">
                        <option value="compact">Á¥ßÂáëÊ®°Âºè</option>
                        <option value="standard">Ê†áÂáÜÊ®°Âºè</option>
                    </select>
                    <button class="btn" onclick="loadExample()">Âä†ËΩΩÁ§∫‰æã</button>
                </div>
            </div>
            <div class="panel-content">
                <textarea id="markdownInput" placeholder="Âú®ËøôÈáåËæìÂÖ•‰Ω†ÁöÑ Markdown ÂÜÖÂÆπ...

üí° ‰ΩøÁî®ÊèêÁ§∫Ôºö
‚Ä¢ Á¥ßÂáëÊ®°ÂºèÔºöÂéªÈô§ÊâÄÊúâÊç¢Ë°åÔºåÈÄÇÂêàÂæÆ‰ø°ÂÖ¨‰ºóÂè∑ÔºàÊé®ËçêÔºâ
‚Ä¢ Ê†áÂáÜÊ®°ÂºèÔºö‰øùÁïôÊ†ºÂºèÔºåÈÄÇÂêàÂÖ∂‰ªñÁºñËæëÂô®
‚Ä¢ ÊîØÊåÅÂµåÂ•óÂàóË°®Ôºö‰ΩøÁî®4‰∏™Á©∫Ê†ºÁº©ËøõË°®Á§∫‰∏ã‰∏ÄÁ∫ß

Á§∫‰æãÔºö
# ËøôÊòØ‰∏ªÊ†áÈ¢ò
## ËøôÊòØÂâØÊ†áÈ¢ò  
### ËøôÊòØÂ∞èÊ†áÈ¢ò

ËøôÊòØ‰∏ÄÊÆµÊ≠£ÊñáÔºåÊîØÊåÅ **Á≤ó‰Ωì** Âíå *Êñú‰Ωì*„ÄÇ

- **‰∏ÄÁ∫ßÂàóË°®È°πÁõÆ1**
    - ‰∫åÁ∫ßÂàóË°®È°πÁõÆ1
    - ‰∫åÁ∫ßÂàóË°®È°πÁõÆ2
        - ‰∏âÁ∫ßÂàóË°®È°πÁõÆ1
        - ‰∏âÁ∫ßÂàóË°®È°πÁõÆ2
- **‰∏ÄÁ∫ßÂàóË°®È°πÁõÆ2**
    - ‰∫åÁ∫ßÂàóË°®È°πÁõÆ3

> ËøôÊòØÂºïÁî®ÂÜÖÂÆπ

```javascript
console.log('Hello, world!');
```

| Ë°®Â§¥1 | Ë°®Â§¥2 |
|---|---|
| ÂçïÂÖÉÊ†º1 | ÂçïÂÖÉÊ†º2 |

Ë°åÂÜÖÂÖ¨ÂºèÔºö$E = mc^2$

ÂùóÁ∫ßÂÖ¨ÂºèÔºö$$ \frac{-b \pm \sqrt{b^2-4ac}}{2a} $$

![ÂõæÁâáÊèèËø∞](https://via.placeholder.com/400x200)

üî• Â§çÂà∂Âà∞ÂæÆ‰ø°ÂÖ¨‰ºóÂè∑Êó∂ËØ∑‰ΩøÁî®„ÄêÁ≤òË¥¥Âπ∂‰øùÁïôÊ†ºÂºè„ÄëÊàñ„ÄêCtrl+Shift+V„Äë
"></textarea>
            </div>
        </div>
        
        <div class="panel">
            <div class="tabs">
                <button class="tab active" onclick="showTab('preview')">üîç È¢ÑËßà</button>
                <button class="tab" onclick="showTab('html')">üìÑ HTML‰ª£Á†Å</button>
            </div>
            
            <div id="previewTab" class="tab-content active">
                <div class="panel-header">
                    <span class="panel-title">üëÄ ÊïàÊûúÈ¢ÑËßà (ÂèØÊªöÂä®Êü•Áúã)</span>
                    <button class="btn" id="copyPreviewBtn" onclick="copyPreview()">Â§çÂà∂Ê†∑Âºè‰ª£Á†Å</button>
                </div>
                <div id="preview" class="wechat-preview"></div>
            </div>
            
            <div id="htmlTab" class="tab-content">
                <div class="panel-header">
                    <span class="panel-title">üìã HTML ‰ª£Á†Å (ÂèØÊªöÂä®Êü•Áúã)</span>
                    <button class="btn" id="copyHtmlBtn" onclick="copyHtml()">Â§çÂà∂‰ª£Á†Å</button>
                </div>
                <textarea id="htmlOutput" readonly></textarea>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqKaLiZWC2GeOhXCI2eJt89KCtEpPlC+bb9HvpYa+5YKS" crossorigin="anonymous"></script>
    <script>
        const wechatStylesCompact = {
            sectionNumber: (match, number) => 
                `<section style="text-align: center; margin: 20px 0 15px 0;"><p style="font-size: 28px; color: rgb(0, 0, 0); line-height: 1.2; font-weight: bold; margin: 0;">${number.padStart(2, '0')}</p></section>`,
            
            h1: (match, text) => 
                `<section style="text-align: center; margin: 25px 0 15px 0;"><p style="min-height: 1em; color: rgb(51, 51, 51); line-height: 1.4; margin: 0;"><strong><span style="background: rgb(126, 58, 242); color: white; padding: 6px 12px; border-radius: 4px; font-size: 16px;">${text}</span></strong></p></section>`,
            
            h2: (match, text) => 
                `<p style="font-size: 20px; font-weight: bold; margin: 25px 0 15px 0; padding-left: 12px; border-left: 4px solid #7E3AF2; line-height: 1.3;"><span style="font-weight: bold; color: #333;">${text}</span></p>`,
            
            h3: (match, text) => 
                `<h3 style="line-height: 1.4; font-size: 16px; margin: 20px 0 10px 0; color: #333; font-weight: bold;">${text}</h3>`,
            
            bold: (match, text) => `<strong style="font-weight: bold; color: #333;">${text}</strong>`,
            
            italic: (match, text) => `<em style="font-style: italic;">${text}</em>`,
            
            unorderedList: (match, text) => 
                `<li style="margin: 5px 0; line-height: 1.6; list-style-type: disc;"><span style="font-size: 14px; color: #333;">${text}</span></li>`,
            
            orderedList: (match, text) => 
                `<li style="margin: 5px 0; line-height: 1.6;"><span style="font-size: 14px; color: #333;">${text}</span></li>`,
            
            blockquote: (match, text) => 
                `<blockquote style="margin: 15px 0; padding: 12px 16px; background: #f8f9fa; border-left: 4px solid #7E3AF2; border-radius: 4px;"><p style="line-height: 1.6; margin: 0; font-size: 14px; color: #555; font-style: italic;">${text}</p></blockquote>`,
            
            codeBlock: (match, lang, code) => 
                `<pre style="background: #f8f9fa; padding: 12px; border-radius: 6px; overflow-x: auto; margin: 15px 0; border: 1px solid #e9ecef; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; line-height: 1.4; color: #333;">${code.trim()}</pre>`,
            
            inlineCode: (match, code) => 
                `<code style="background: #f1f3f4; padding: 2px 6px; border-radius: 3px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; color: #d73a49;">${code}</code>`,
            
            image: (match, alt, src) => {
                const altText = alt ? `<p style="font-size: 12px; color: #999; margin: 5px 0 0 0; font-style: italic; text-align: center;">${alt}</p>` : '';
                return `<section style="text-align: center; margin: 20px 0;"><img src="${src}" alt="${alt}" style="max-width: 100%; height: auto; border-radius: 6px;">${altText}</section>`;
            },
            
            link: (match, text, url) => 
                `<a href="${url}" style="color: #7E3AF2; text-decoration: none; border-bottom: 1px solid #7E3AF2;" target="_blank">${text}</a>`,
            
            paragraph: (match, text) => {
                if (text.trim() === '') return '';
                return `<p style="line-height: 1.7; margin: 12px 0; font-size: 15px; color: #333; text-align: justify;">${text}</p>`;
            }
        };

        // Ê†áÂáÜÊ®°ÂºèÊ†∑ÂºèÔºà‰øùÊåÅÂéüÊúâÊ†ºÂºèÔºåÈÄÇÂΩìÊç¢Ë°åÔºâ
        const wechatStylesStandard = {
            sectionNumber: (match, number) => 
                `<section style="text-align: center; margin: 30px 0;">
                    <p style="font-size: 28px; color: rgb(0, 0, 0); line-height: 40px; font-weight: bold;">
                        ${number.padStart(2, '0')}
                    </p>
                </section>`,
            
            h1: (match, text) => 
                `<section style="text-align: center; margin: 30px 0 20px 0;">
                    <p style="min-height: 1em; color: rgb(51, 51, 51); line-height: 22px;">
                        <strong>
                            <span style="background: rgb(126, 58, 242); color: white; padding: 6px 12px; border-radius: 4px;">
                                ${text}
                            </span>
                        </strong>
                    </p>
                </section>`,
            
            h2: (match, text) => 
                `<p style="font-size: 22px; font-weight: bold; margin: 30px 0 20px 0; padding-left: 12px; border-left: 4px solid #7E3AF2; line-height: 1.4;">
                    <span style="font-weight: bold; color: #333;">${text}</span>
                </p>`,
            
            h3: (match, text) => 
                `<h3 style="line-height: 1.5em; font-size: 18px; margin: 20px 0 10px 0; color: #333;">
                    <span style="font-weight: bold;">${text}</span>
                </h3>`,
            
            bold: (match, text) => `<strong style="font-weight: bold; color: #333;">${text}</strong>`,
            
            italic: (match, text) => `<em style="font-style: italic;">${text}</em>`,
            
            unorderedList: (match, text) => 
                `<li style="margin: 8px 0; line-height: 1.6;">
                    <span style="font-size: 14px; color: #333;">${text}</span>
                </li>`,
            
            orderedList: (match, text) => 
                `<li style="margin: 8px 0; line-height: 1.6;">
                    <span style="font-size: 14px; color: #333;">${text}</span>
                </li>`,
            
            blockquote: (match, text) => 
                `<blockquote style="margin: 20px 0; padding: 15px 20px; background: #f8f9fa; border-left: 4px solid #7E3AF2; border-radius: 4px;">
                    <p style="line-height: 1.6; margin: 0; font-size: 14px; color: #555; font-style: italic;">
                        ${text}
                    </p>
                </blockquote>`,
            
            codeBlock: (match, lang, code) => 
                `<pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto; margin: 20px 0; border: 1px solid #e9ecef;">
                    <code style="font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; line-height: 1.4; color: #333;">${code.trim()}</code>
                </pre>`,
            
            inlineCode: (match, code) => 
                `<code style="background: #f1f3f4; padding: 2px 6px; border-radius: 3px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; color: #d73a49;">${code}</code>`,
            
            image: (match, alt, src) => {
                const altText = alt ? `<p style="font-size: 12px; color: #999; margin: 8px 0 0 0; font-style: italic;">${alt}</p>` : '';
                return `<section style="text-align: center; margin: 25px 0;">
                    <img src="${src}" alt="${alt}" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    ${altText}
                </section>`;
            },
            
            link: (match, text, url) => 
                `<a href="${url}" style="color: #7E3AF2; text-decoration: none; border-bottom: 1px solid #7E3AF2;" target="_blank">${text}</a>`,
            
            paragraph: (match, text) => {
                if (text.trim() === '') return '';
                return `<p style="line-height: 1.8; margin: 15px 0; font-size: 15px; color: #333; text-align: justify;">${text}</p>`;
            }
        };
        
        function createWechatRenderer(mode) {
            const wechatStyles = mode === 'compact' ? wechatStylesCompact : wechatStylesStandard;
            const renderer = new marked.Renderer();

            renderer.heading = (text, level, raw) => {
                if (level === 1) return wechatStyles.h1(raw, text);
                if (level === 2) return wechatStyles.h2(raw, text);
                if (level === 3) {
                    const sectionMatch = raw.match(/^###\s(\d+)/);
                    if (sectionMatch && raw.trim().split(/\s+/).length === 2) {
                        return wechatStyles.sectionNumber(raw, sectionMatch[1]);
                    }
                    return wechatStyles.h3(raw, text);
                }
                return `<h${level} style="font-size: ${18 - level}px; font-weight: bold; margin: 15px 0;">${text}</h${level}>`;
            };

            renderer.paragraph = (text) => {
                // ÈÅøÂÖç marked.js ÁªôÂ∑≤ÁªèÊúâÊ†∑ÂºèÁöÑÂùóÔºàÂ¶ÇKaTeXÊ∏≤ÊüìÁöÑÂùóÔºâÂÜçÊ¨°Â•ó‰∏ä <p> Ê†áÁ≠æ
                if (text.trim().startsWith('<section') && text.trim().endsWith('</section>')) {
                    return text;
                }
                return wechatStyles.paragraph(null, text);
            };

            renderer.strong = (text) => wechatStyles.bold(null, text);
            renderer.em = (text) => wechatStyles.italic(null, text);

            renderer.list = (body, ordered, start) => {
                const tag = ordered ? 'ol' : 'ul';
                const styles = mode === 'compact' 
                    ? `list-style-position: inside; padding: 0; margin: 8px 0;`
                    : `padding-left: 25px; margin: 15px 0;`;
                return `<${tag} style="${styles}">${body}</${tag}>`;
            };

            renderer.listitem = (text) => {
                const style = mode === 'compact'
                    ? `margin: 5px 0; line-height: 1.6; font-size: 14px; color: #333;`
                    : `margin: 8px 0; line-height: 1.6; font-size: 14px; color: #333;`;
                // Â§ÑÁêÜÂµåÂ•óÂàóË°®ÁöÑ<p>Ê†áÁ≠æÈóÆÈ¢ò
                const cleanedText = text.replace(/<p>([\s\S]*?)<\/p>/g, '$1');
                return `<li style="${style}">${cleanedText}</li>`;
            };

            renderer.blockquote = (quote) => {
                const unwrappedQuote = quote.replace(/^<p>([\s\S]*)<\/p>\n?$/, '$1');
                return wechatStyles.blockquote(null, unwrappedQuote);
            };

            renderer.code = (code, lang, escaped) => wechatStyles.codeBlock(null, lang, code);
            renderer.codespan = (code) => wechatStyles.inlineCode(null, code);
            renderer.image = (href, title, text) => wechatStyles.image(null, text, href);
            renderer.link = (href, title, text) => wechatStyles.link(null, text, href);

            renderer.table = (header, body) => {
                return `<table style="border-collapse: collapse; margin: 15px 0; width: 100%; border: 1px solid #e2e8f0;"><thead>${header}</thead><tbody>${body}</tbody></table>`;
            };
            
            renderer.tablerow = (content) => {
                return `<tr style="border-bottom: 1px solid #e2e8f0;">${content}</tr>`;
            };

            renderer.tablecell = (content, flags) => {
                const tag = flags.header ? 'th' : 'td';
                const textAlign = flags.align ? `text-align: ${flags.align};` : '';
                const style = flags.header
                    ? `background-color: #f8fafc; font-weight: 600; color: #334155; border: 1px solid #e2e8f0; padding: 10px 12px; ${textAlign}`
                    : `border: 1px solid #e2e8f0; padding: 10px 12px; ${textAlign}`;
                return `<${tag} style="${style}">${content}</${tag}>`;
            };

            return renderer;
        }

        function convertMarkdownToWechat(markdown) {
            const mode = document.getElementById('modeSelect').value;
            
            // 1. ‰øùÊä§Êï∞Â≠¶ÂÖ¨ÂºèÔºåÊõøÊç¢‰∏∫Âç†‰ΩçÁ¨¶
            const mathPlaceholders = {};
            let mathCounter = 0;
            
            // ÂùóÁ∫ßÂÖ¨Âºè
            markdown = markdown.replace(/\$\$([\s\S]*?)\$\$/g, (match, latex) => {
                const placeholder = `__MATH_BLOCK_${mathCounter++}__`;
                mathPlaceholders[placeholder] = latex;
                return placeholder;
            });

            // Ë°åÂÜÖÂÖ¨Âºè
            markdown = markdown.replace(/\$([^$]+?)\$/g, (match, latex) => {
                const placeholder = `__MATH_INLINE_${mathCounter++}__`;
                mathPlaceholders[placeholder] = latex;
                return placeholder;
            });

            // 2. ‰ΩøÁî® marked.js ËøõË°åËΩ¨Êç¢
            const renderer = createWechatRenderer(mode);
            marked.setOptions({ renderer });
            let html = marked.parse(markdown);

            // 3. ÊÅ¢Â§çÊï∞Â≠¶ÂÖ¨ÂºèÂπ∂Áî® KaTeX Ê∏≤Êüì
            html = html.replace(/__MATH_BLOCK_(\d+)__/g, (match) => {
                const latex = mathPlaceholders[match];
                try {
                    return `<section style="text-align:center; margin: 15px 0; overflow-x: auto; overflow-y: hidden;">${katex.renderToString(latex, { throwOnError: false, displayMode: true })}</section>`;
                } catch (e) {
                    return `<p style="color:red;">KaTeX Error: ${e.message}</p>`;
                }
            });
            html = html.replace(/__MATH_INLINE_(\d+)__/g, (match) => {
                const latex = mathPlaceholders[match];
                try {
                    return katex.renderToString(latex, { throwOnError: false, displayMode: false });
                } catch (e) {
                    return `<code style="color:red; font-size: 1em;">KaTeX Error</code>`;
                }
            });
            
            // 4. Ê†πÊçÆÊ®°ÂºèËøõË°åÊúÄÁªàÊ∏ÖÁêÜ
            if (mode === 'compact') {
                html = html.replace(/\n\s*\n/g, '');
                html = html.replace(/\s{2,}/g, ' ');
                html = html.replace(/>\s+</g, '><');
            } else {
                html = html.replace(/\n\s*\n\s*\n/g, '\n\n');
            }
            
            return `<div style="font-family: 'PingFang SC', system-ui, -apple-system, 'Helvetica Neue', 'Microsoft YaHei', Arial, sans-serif; color: rgba(0, 0, 0, 0.9); max-width: 100%; overflow-wrap: break-word;">${html}</div>`;
        }
        
        function updateOutput() {
            const markdown = document.getElementById('markdownInput').value;
            const html = convertMarkdownToWechat(markdown);
            
            document.getElementById('htmlOutput').value = html;
            document.getElementById('preview').innerHTML = html;
            
            // Ëá™Âä®ÊªöÂä®Âà∞È¢ÑËßàÈ°∂ÈÉ®
            document.getElementById('preview').scrollTop = 0;
        }
        
        function showTab(tabName) {
            // ÁßªÈô§ÊâÄÊúâÊ¥ªÂä®Áä∂ÊÄÅ
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // ÊøÄÊ¥ªÈÄâ‰∏≠ÁöÑÊ†áÁ≠æÈ°µ
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }
        
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                return true;
            } catch (err) {
                // ÈôçÁ∫ßÊñπÊ°à
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                const success = document.execCommand('copy');
                document.body.removeChild(textArea);
                return success;
            }
        }
        
        async function copyHtml() {
            const html = document.getElementById('htmlOutput').value;
            const success = await copyToClipboard(html);
            const btn = document.getElementById('copyHtmlBtn');
            
            if (success) {
                btn.textContent = '‚úÖ Â∑≤Â§çÂà∂';
                btn.classList.add('success');
                setTimeout(() => {
                    btn.textContent = 'Â§çÂà∂‰ª£Á†Å';
                    btn.classList.remove('success');
                }, 2000);
            } else {
                alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂');
            }
        }
        
        async function copyPreview() {
            const html = document.getElementById('htmlOutput').value;
            const success = await copyToClipboard(html);
            const btn = document.getElementById('copyPreviewBtn');
            
            if (success) {
                btn.textContent = '‚úÖ Â∑≤Â§çÂà∂';
                btn.classList.add('success');
                setTimeout(() => {
                    btn.textContent = 'Â§çÂà∂Ê†∑Âºè‰ª£Á†Å';
                    btn.classList.remove('success');
                }, 2000);
            } else {
                alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®Â§çÂà∂');
            }
        }
        
        function loadExample() {
            const exampleMarkdown = `# AIËßÜËßâÈ¢ÜÂüüÁöÑ"ÈìÅ‰∏âËßí"

## ‰ªñ‰ª¨ÊòØË∞ÅÔºü

**Lucas Beyer„ÄÅAlexander Kolesnikov Âíå Xiaohua Zhai** Ë¢´‰∏öÁïåÁß∞‰∏∫ AI ËßÜËßâÈ¢ÜÂüüÁöÑ"ÈìÅ‰∏âËßí"„ÄÇ

### Vision Transformer (ViT)ÔºöÁªôAIÊç¢‰∫ÜÂâØ"ÁúºÈïú"

**ÂéüÊù•VSÁé∞Âú®**Ôºö

- **ÂéüÊù•ÔºàCNNÊñπÂºèÔºâ**ÔºöÂÉè‰∏Ä‰∏™Èù†ÊîæÂ§ßÈïúÂ±ÄÈÉ®Êü•ÁúãÂõæÂÉèÁöÑ‰∫∫
    - CNN ÂÉè‰∏Ä‰∏™‰∫∫ÊãøÁùÄÊîæÂ§ßÈïúÂú®ÂõæÁâá‰∏ä**‰ªéÂ∑¶Âà∞Âè≥„ÄÅ‰ªé‰∏äÂà∞‰∏ãÂú∞ÊªëÂä®ËßÇÂØü**
    - ÊØèÊ¨°Âè™ÂÖ≥Ê≥®ÂõæÁâáÁöÑ**Â±ÄÈÉ®Âå∫ÂüüÔºàÂ∞èÊñπÂùóÔºâ**Ôºå‰ªé‰∏≠ÊèêÂèñÁ∫πÁêÜ„ÄÅËæπÁºòÁ≠â‰ø°ÊÅØ
    - Â§öÂ±ÇÂè†Âä†ÂêéÔºåÂÆÉÈÄêÊ∏êÊûÑÂª∫Âá∫ÂØπÊï¥‰ΩìÂõæÂÉèÁöÑÁêÜËß£
- **Áé∞Âú®ÔºàViTÊñπÂºèÔºâ**ÔºöÂÉè‰∏Ä‰∏™‰∫∫ÊääÊï¥Âº†ÂõæÂàáÊàêÊãºÂõæÂùóÔºåÁÑ∂Âêé"ÈòÖËØª"Ëøô‰∫õÊãºÂõæÂùóÁöÑÂÖ≥Á≥ª
    - ViT È¶ñÂÖàÊääÊï¥Âº†ÂõæÂÉè**ÂàáÊàê‰∏Ä‰∏™‰∏™Â∞èÂùóÔºàpatchÔºâ**ÔºåÊØè‰∏™ÂùóÂÉèÊòØ‰∏ÄÂº†Âç°Áâá
    - ÊääÊØè‰∏™Âç°Áâá"ÁºñÁ†Å"‰∏∫‰∏Ä‰∏™ÂêëÈáèÔºåÁÑ∂ÂêéÂÉè Transformer ÁúãÂè•Â≠ê‰∏ÄÊ†∑
        - ‰ΩøÁî®Ê≥®ÊÑèÂäõÊú∫Âà∂ÊçïÊçâÂÆÉ‰ª¨‰πãÈó¥ÁöÑÂÖ≥Á≥ª
        - ËÉΩÂêåÊó∂ÂÖ≥Ê≥®ÂõæÁâá‰ªªÊÑè‰∏§‰∏™‰ΩçÁΩÆ
    - ÂÆÉ‰∏çÂÉè CNN ÈÇ£Ê†∑ÂÖ≥Ê≥®ÈÇªËøëÂå∫ÂüüÔºåËÄåÊòØËÉΩ‰∏ÄÂºÄÂßãÂ∞±‰ªéÂÖ®Â±ÄÂá∫ÂèëËøõË°åÂª∫Ê®°

### Ê†∏ÂøÉË¥°ÁåÆ

‰ªñ‰ª¨ÁöÑ‰∏ªË¶ÅÁ†îÁ©∂ÊàêÊûúÂåÖÊã¨Ôºö

- **Big Transfer (BiT)**ÔºöËÆ©AIÊàê‰∏∫"Â≠¶Èú∏"
    - Â§ßËßÑÊ®°È¢ÑËÆ≠ÁªÉÁ≠ñÁï•ÔºöÂú®3‰∫øÂº†ÂõæÁâáÁöÑË∂ÖÂ§ßÊï∞ÊçÆÈõÜ‰∏äËÆ≠ÁªÉAI
    - Ê†áÂáÜÂåñËøÅÁßªÊµÅÁ®ãÔºöÂª∫Á´ã‰∫Ü‰∏ÄÂ•ó"È¢ÑËÆ≠ÁªÉ‚ÜíÂæÆË∞É"ÁöÑÊ†áÂáÜÂÅöÊ≥ï
    - BiT-HyperRuleËßÑÂàôÔºöÊ†πÊçÆ‰ªªÂä°Â§ßÂ∞èËá™Âä®Ë∞ÉÊï¥ËÆ≠ÁªÉÂèÇÊï∞
- **Vision Transformer (ViT)**ÔºöÁªôAIÊç¢‰∫ÜÂâØ"ÁúºÈïú"  
    - ÂõæÂÉèÂ∫èÂàóÂåñÔºöÊää2DÂõæÁâáÂèòÊàê1DÂ∫èÂàóÔºåÂ∞±ÂÉèÊääÊñáÂ≠óÊéíÊàê‰∏ÄË°å
    - ÂÖ®Â±ÄÊ≥®ÊÑèÂäõÊú∫Âà∂ÔºöËÉΩÂêåÊó∂ÂÖ≥Ê≥®ÂõæÁâá‰ªªÊÑè‰∏§‰∏™‰ΩçÁΩÆÁöÑÂÖ≥Á≥ª
    - Áªü‰∏ÄÊû∂ÊûÑÔºöÂõæÁâáÂíåÊñáÂ≠óÁî®ÂêåÊ†∑ÁöÑTransformerÂ§ÑÁêÜ
- **MLP-Mixer**ÔºöÊûÅÁÆÄ‰∏ª‰πâÁöÑËÉúÂà©
    - Token-Mixing MLPÔºàÁ©∫Èó¥ÊêÖÊãåÂô®ÔºâÔºöÊ∑∑Âêà‰∏çÂêå‰ΩçÁΩÆÈó¥ÁöÑ‰ø°ÊÅØ
    - Channel-Mixing MLPÔºàÁâπÂæÅÊêÖÊãåÂô®ÔºâÔºöÊ∑∑ÂêàÊØè‰∏™‰ΩçÁΩÆÂÜÖÈÉ®ÁöÑÁâπÂæÅ
    - ÊåëÊàò‰º†ÁªüËÆ§Áü•ÔºöËØÅÊòéÁÆÄÂçïÊúâÊó∂Êõ¥ÊúâÊïà

### ÊäÄÊúØÁªÜËäÇÂØπÊØî

‰∏ãÈù¢ÊòØ‰∏Ä‰∏™Ë°®Ê†ºÁ§∫‰æãÔºö

| ÁâπÊÄß | ‰º†ÁªüCNN | Vision Transformer (ViT) |
| :--- | :--- | :--- |
| **Ê†∏ÂøÉÊìç‰Ωú** | Â±ÄÈÉ®Âç∑ÁßØ | ÂÖ®Â±ÄËá™Ê≥®ÊÑèÂäõ |
| **ÊÑüÂèóÈáé** | ÈÄêÊ≠•Êâ©Â§ß | ‰∏ÄÂºÄÂßãÂç≥ÂÖ®Â±Ä |
| **Êï∞ÊçÆÂ§ÑÁêÜ** | 2DÂõæÂÉèÊï∞ÁªÑ | 1DÂ∫èÂàóÔºàPatchesÔºâ |
| **ËÆ°ÁÆóÂ§çÊùÇÂ∫¶**| O(k¬≤ * C_in * C_out) | O(n¬≤ * d) |

‰ª•ÂèäÊï∞Â≠¶ÂÖ¨ÂºèÔºö

- **Ë°åÂÜÖÂÖ¨Âºè**: ËëóÂêçÁöÑË¥®ËÉΩÊñπÁ®ãÊòØ $E = mc^2$„ÄÇ
- **ÂùóÁ∫ßÂÖ¨Âºè**: Ê±ÇËß£‰∫åÊ¨°ÊñπÁ®ã $ax^2 + bx + c = 0$ ÁöÑÂÖ¨ÂºèÊòØÔºö
$$ x = \frac{-b \pm \sqrt{b^2-4ac}}{2a} $$

> Â¶ÇÊûúËØ¥ AI ÊòØ‰∏™‰∏çÊñ≠Â≠¶‰π†ÁöÑÂ≠¶ÁîüÔºåÈÇ£Ëøô‰∏â‰ΩçÂ∞±ÊòØÈô™ÂÆÉ‰ªé"Áúã‰∏çÊáÇÂõæÁâá"Âà∞"ËÉΩÁúãÂõæËØ¥ËØù"ÁöÑËÄÅÂ∏à„ÄÇ

### Â∫îÁî®Âú∫ÊôØÂ±ïÁ§∫

Ëøô‰∫õÊäÄÊúØÂ∑≤ÁªèË¢´ÂπøÊ≥õÂ∫îÁî®Âú®Ôºö

- **ËÆ°ÁÆóÊú∫ËßÜËßâÈ¢ÜÂüü**
    - ÂõæÂÉèÂàÜÁ±ª‰ªªÂä°
        - ImageNet Êï∞ÊçÆÈõÜ
        - ÁªÜÁ≤íÂ∫¶ÂàÜÁ±ª
    - ÁõÆÊ†áÊ£ÄÊµã‰ªªÂä°
        - COCO Êï∞ÊçÆÈõÜ
        - ÂÆûÊó∂Ê£ÄÊµãÁ≥ªÁªü
    - ËØ≠‰πâÂàÜÂâ≤‰ªªÂä°
        - ÂÉèÁ¥†Á∫ßÂàÜÁ±ª
        - ÂåªÂ≠¶ÂΩ±ÂÉèÂàÜÊûê
- **Â§öÊ®°ÊÄÅÂ∫îÁî®È¢ÜÂüü**
    - ÂõæÊñáÁêÜËß£‰ªªÂä°
        - ÁúãÂõæËØ¥ËØù
        - ËßÜËßâÈóÆÁ≠î
    - Ë∑®Ê®°ÊÄÅÊ£ÄÁ¥¢
        - ÂõæÊñáÂåπÈÖç
        - ÂÜÖÂÆπÊé®Ëçê
- **Â∑•‰∏öÂ∫îÁî®È¢ÜÂüü**
    - Ëá™Âä®È©æÈ©∂ÊäÄÊúØ
        - Ë∑ØÂÜµËØÜÂà´
        - ÈöúÁ¢çÁâ©Ê£ÄÊµã
        - ‰∫§ÈÄöÊ†áÂøóËØÜÂà´
    - ÂåªÂ≠¶ÂΩ±ÂÉèËØäÊñ≠
        - XÂÖâÁâáÂàÜÊûê
        - CTÊâ´ÊèèÂ§ÑÁêÜ
        - ÁóÖÁêÜÂàáÁâáÊ£ÄÊü•
    - Êô∫ËÉΩÂà∂ÈÄ†Á≥ªÁªü
        - Ë¥®ÈáèÊ£ÄÊµã
        - Áº∫Èô∑ËØÜÂà´
        - Ëá™Âä®ÂåñÂàÜÊã£

![AIËßÜËßâÂèëÂ±ï](https://via.placeholder.com/600x300/7E3AF2/ffffff?text=AI+Vision+Evolution)

**‰∫ÜËß£Êõ¥Â§ö**Ôºö[ÁÇπÂáªÊü•ÁúãËØ¶ÁªÜËÆ∫Êñá](https://example.com)`;

            document.getElementById('markdownInput').value = exampleMarkdown;
            updateOutput();
            
            // ÊªöÂä®Âà∞ËæìÂÖ•Âå∫ÂüüÈ°∂ÈÉ®
            document.getElementById('markdownInput').scrollTop = 0;
        }
        
        // ÁªëÂÆö‰∫ã‰ª∂
        document.getElementById('markdownInput').addEventListener('input', updateOutput);
        
        // ÂàùÂßãÂåñ
        updateOutput();
    </script>
</body>
</html>
